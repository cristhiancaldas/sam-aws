openapi: 3.0.0
info:
  version: 1.0.0
  title: supplier-integration-api
x-amazon-apigateway-request-validators:
  all:
    validateRequestBody: true
    validateRequestParameters: true
  params-only:
    validateRequestBody: false
    validateRequestParameters: true
  body:
    validateRequestBody: true
    validateRequestParameters: false
  none:
    validateRequestBody: false
    validateRequestParameters: false
paths:
  /credits:
    post:
      operationId: PostSupplierCreditsMethod
      description: PostSupplierCreditsMethod method with API Gateway & Open API.
      requestBody:
        description: addCreditRequest
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AddCredits"

      security:
        - bearerAuth: []
      x-amazon-apigateway-request-validator: params-only
      x-amazon-apigateway-integration:
        httpMethod: POST
        timeoutInMillis: 29000
        type: "aws_proxy"
      responses:
        202:
          description: "Accepted for processing"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseSuccess"
        400:
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        401:
          description: "Unauthorized"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        412:
          description: "Duplicate request"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        500:
          description: "Internal Server Error"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
  /orders:
    get:
      operationId: GetOrderMethod
      summary: "Find order"
      description: "Find order"
      parameters:
        - name: from
          in: query
          description: "Optional to date value: Format [YYYY-MM-DD (HH:MM:SS)], if full detail is selected HH:MM:SS is mandatory"
          required: false
          schema:
            type: string
        - name: first
          in: query
          description: "Maximum number of elements"
          required: false
          schema:
            type: integer
            default: 50
            maximum: 100
            format: int32
        - name: status
          in: query
          description: "Filter by the status order"
          required: false
          schema:
            type: string
        - name: to
          in: query
          description: "Optional to date value: Format [YYYY-MM-DD (HH:MM:SS)], if full detail is selected HH:MM:SS is mandatory"
          required: false
          schema:
            type: string
        - name: full_detail
          in: query
          description: Show full detail order
          required: true
          schema:
            type: boolean
            default: false
        - name: after
          in: query
          description: Last evaluated key
          required: false
          schema:
            type: string
      security:
        - bearerAuth: []
      x-amazon-apigateway-authorizer:
        type: none
      x-amazon-apigateway-integration:
        httpMethod: POST
        timeoutInMillis: 29000
        type: "aws_proxy"
        responses:
          default:
            statusCode: "200"
      responses:
        200:
          description: "OK"
        401:
          description: "Unauthorized"
        403:
          description: "Forbidden"
        404:
          description: "Bad Request"
        500:
          description: "Internal Server Error"

components:
  schemas:

    PromotionDetailResponse:
      type: object
      properties:
        discount:
          $ref: "#/components/schemas/PromotionDiscountTargetResponse"
        free:
          $ref: "#/components/schemas/PromotionFreeTargetResponse"

    PromotionTarget:
      type: object
      properties:
        priceListCodes:
          type: array
          items:
            type: string
        customers:
          type: array
          items:
            type: string

    PromotionDiscountTargetResponse:
      type: object
      properties:
        progressive:
          type: boolean
        eans:
          type: array
          items:
            type: string
        steps:
          type: array
          items:
            $ref: "#/components/schemas/PromotionStepDiscount"
        maxUnitsTotalToUse:
          type: integer
          format: int64
        sumUnitsTotalUsed:
          type: integer
          format: int64
        maxUnitsPerCustomerToUse:
          type: integer
          format: int64

    PromotionFreeTargetResponse:
      type: object
      properties:
        eans:
          type: array
          items:
            type: string
        step:
          $ref: "#/components/schemas/PromotionStepFree"
        maxUnitsTotalToUse:
          type: integer
          format: int64
        sumUnitsTotalUsed:
          type: integer
          format: int64
        maxUnitsPerCustomerToUse:
          type: integer
          format: int64

    PromotionStepDiscount:
      type: object
      properties:
        quantity:
          $ref: "#/components/schemas/PromotionQuantity"
        display:
          $ref: "#/components/schemas/PromotionDisplay"
        discount:
          $ref: "#/components/schemas/PromotionDiscount"

    PromotionStepFree:
      type: object
      properties:
        quantity:
          $ref: "#/components/schemas/PromotionQuantity"
        display:
          $ref: "#/components/schemas/PromotionDisplay"
        eanFree:
          type: string
        quantityFree:
          type: integer
          format: int64
        displayFree:
          $ref: "#/components/schemas/PromotionDisplay"

    PromotionDetailFreeMaxUnits:
      type: object
      properties:
        bought:
          type: integer
          format: int64
        given:
          type: integer
          format: int64

    PromotionDetailFreeSumUnitsResponse:
      type: object
      properties:
        unitsBought:
          type: integer
          format: int64
        unitsGiven:
          type: integer
          format: int64

    PromotionQuantity:
      type: object
      properties:
        min:
          type: integer
          format: int64
        max:
          type: integer
          format: int64

    PromotionDisplay:
      type: object
      properties:
        units:
          type: integer
          format: int64

    PromotionDiscount:
      type: object
      properties:
        amount:
          $ref: "#/components/schemas/PromotionDiscountType"
        percentage:
          $ref: "#/components/schemas/PromotionDiscountType"

    PromotionDiscountType:
      type: object
      properties:
        value:
          type: integer
          format: int64

    AddCredits:
      type: object
      properties:
        customer:
          $ref: "#/components/schemas/CustomerIntegrationIdentification"
        amount:
          type: number

    PaginatorSupplierResponse:
      type: object
      properties:
        edges:
          type: array
          items:
            $ref: "#/components/schemas/SupplierEdgeOrderDetailResponse"
        pageInfo:
          $ref: "#/components/schemas/PageInfo"

    SupplierEdgeOrderDetailResponse:
      type: object
      properties:
        cursor:
          $ref: "#/components/schemas/ConnectionCursor"
        node:
          $ref: "#/components/schemas/SupplierOrderDetailResponse"

    ConnectionCursor:
      type: object
      properties:
        value:
          type: string

    SupplierOrderDetailResponse:
      type: object
      properties:
        address:
          $ref: "#/components/schemas/AddressResponse"
        buyer:
          $ref: "#/components/schemas/CustomerResponse"
        cancel_requested:
          type: boolean
        created:
          type: string
        customer_order_id:
          type: integer
          format: int64
        estimated_shipping:
          type: string
        id:
          type: integer
          format: int64
        payment:
          $ref: "#/components/schemas/PaymentResponse"
        products:
          type: array
          items:
            $ref: "#/components/schemas/OrderItemResponse"
        shipped:
          type: string
        shipping_cost:
          type: integer
          format: int64
        status:
          type: string
          enum:
            - PENDING
            - CONFIRMED
            - SHIPPED
            - CANCELED
        total:
          type: integer
          format: int64
        units:
          type: integer
          format: int64
        appliedPromotions:
          type: array
          items:
            $ref: "#/components/schemas/AppliedPromotion"
      title: SupplierOrderDetailResponse

    AppliedPromotion:
      type: object
      properties:
        promotion:
          $ref: "#/components/schemas/Promotion"
        involvedCartItems:
          type: array
          items:
            type: string

    Promotion:
      type: object
      properties:
        code:
          type: string
        id:
          type: string
        description:
          type: string
        type:
          type: string

    AddressResponse:
      type: object
      properties:
        additional_info:
          type: string
        formatted_address:
          type: string
        postal_code:
          type: string
        shipping_preference:
          type: array
          items:
            $ref: "#/components/schemas/ShippingPreference"
      title: AddressResponse

    CustomerResponse:
      type: object
      properties:
        client_code:
          type: string
        email:
          type: string
        first_name:
          type: string
        id:
          type: integer
          format: int64
        last_name:
          type: string
        legal_address:
          $ref: "#/components/schemas/AddressResponse"
        legal_id:
          type: string
        name:
          type: string
        phone:
          type: string
        phone_alternative:
          type: string
      title: CustomerResponse

    PaymentResponse:
      type: object
      properties:
        wabipay:
          "$ref": "#/components/schemas/WabiPayResponse"
      title: PaymentResponse

    OrderItemResponse:
      type: object
      properties:
        ean:
          type: string
        id:
          type: integer
          format: int64
        order_item_id:
          type: integer
          format: int64
        partial_summary:
          $ref: "#/components/schemas/PartialSummaryResponse"
        price:
          type: integer
          format: int64
        original_price:
          type: integer
          format: int64
        price_list:
          $ref: "#/components/schemas/PriceListResponse"
        quantity:
          type: integer
          format: int64
        title:
          type: string
        units:
          type: integer
          format: int64
      title: OrderItemResponse

    ShippingPreference:
      type: object
      properties:
        FRIDAY:
          type: string
        MONDAY:
          type: string
        SATURDAY:
          type: string
        SUNDAY:
          type: string
        THURSDAY:
          type: string
        TUESDAY:
          type: string
        WEDNESDAY:
          type: string
      title: ShippingPreference

    WabiPayResponse:
      type: object
      properties:
        credits:
          $ref: "#/components/schemas/MoneyResponse"
        money:
          $ref: "#/components/schemas/MoneyResponse"
      title: WabiPayResponse

    MoneyResponse:
      type: object
      properties:
        customer_paid:
          type: integer
          format: int64
        supplier_received:
          type: integer
          format: int64
      title: MoneyResponse

    PartialSummaryResponse:
      type: object
      properties:
        quantity:
          type: integer
          format: int64
      title: PartialSummaryResponse

    PriceListResponse:
      type: object
      properties:
        id:
          type: integer
          format: int64
        name:
          type: string
        price_list_code:
          type: string
      title: PriceListResponse

    PageInfo:
      type: object
      properties:
        hasNextPage:
          type: boolean
        hasPreviousPage:
          type: boolean
        startCursor:
          $ref: "#/components/schemas/PageInfoCursor"
        endCursor:
          $ref: "#/components/schemas/PageInfoCursor"
      title: PageInfo

    PageInfoCursor:
      type: object
      properties:
        value:
          type: string
      title: PageInfoCursor

    ConfirmOrderRequest:
      type: object
      properties:
        partialOrderItemSummaryList:
          type: array
          items:
            $ref: "#/components/schemas/PartialSummary"
        shipAt:
          type: string
        supplierClientCode:
          type: string
        total:
          type: string
      title: ConfirmOrderRequest

    PartialSummary:
      type: object
      properties:
        orderItemId:
          type: integer
          format: int64
        quantity:
          type: integer
          format: int32
      title: PartialSummary

    CancelSupplierOrderRequest:
      type: object
      properties:
        comment:
          type: string
        supplierCancelOptionReason:
          type: string
          enum:
            - INCORRECT_PRICE
            - INCORRECT_TAX
            - CUSTOMER_CLOSED
            - INSUFFICIENT_AMOUNT
            - CUSTOMER_REGRET
            - NO_STOCK
            - STORE_OUTSIDE_COVERAGE_AREA
            - OTHERS
            - ACCEPT_CANCELED_ORDER
      title: CancelSupplierOrderRequest

    ShipOrderRequest:
      type: object
      properties:
        amount:
          type: number
        partialOrderItemSummaryList:
          type: array
          items:
            $ref: "#/components/schemas/PartialSummary"
        receipts:
          type: array
          items:
            type: string
      title: ShipOrderRequest

    UploadReceiptFileObject:
      type: object
      properties:
        id:
          type: string
      title: UploadReceiptFileObject

    SupplierProductResponse:
      type: object
      properties:
        pageInfo:
          $ref: "#/components/schemas/PageInfo"
        edges:
          type: array
          items:
            $ref: "#/components/schemas/EdgeSupplierProduct"

    EdgeSupplierProduct:
      type: object
      properties:
        cursor:
          $ref: "#/components/schemas/ConnectionCursor"
        node:
          $ref: "#/components/schemas/SupplierProduct"

    SupplierProduct:
      type: object
      properties:
        ean:
          type: string
        title:
          type: string
        displays:
          type: array
          items:
            $ref: "#/components/schemas/SupplierProductDisplay"

    SupplierProductDisplay:
      type: object
      properties:
        units:
          type: integer
        sku:
          type: string

    SupplierProductChangeRequest:
      type: object
      properties:
        enabled:
          type: boolean
        max_units:
          type: integer
          format: int64
        min_units:
          type: integer
          format: int64
        price:
          type: number
        price_list_code:
          type: string
        units:
          type: integer
          format: int64
      title: SupplierProductChangeRequest

    PriceListProductPriceRequest:
      type: object
      properties:
        price_lists:
          type: array
          items:
            $ref: "#/components/schemas/PriceListProductPrice"
      title: PriceListProductPriceRequest

    PriceListProductPrice:
      type: object
      properties:
        price_list_code:
          type: string
        products:
          type: array
          items:
            $ref: "#/components/schemas/ProductPrice"
      title: PriceListProductPrice

    ProductPrice:
      type: object
      properties:
        ean:
          type: string
        enabled:
          type: boolean
        max_units:
          type: integer
          format: int64
        min_units:
          type: integer
          format: int64
        price:
          type: number
        units:
          type: integer
          format: int64
      title: ProductPrice

    ProductSkuRequest:
      type: object
      properties:
        products:
          type: array
          items:
            $ref: "#/components/schemas/ProductSku"

    ProductSku:
      type: object
      properties:
        ean:
          type: string
        units:
          type: integer
          format: int64
        sku:
          type: string

    SupplierProductToggleRequest:
      type: object
      properties:
        price_list_code:
          type: string
          required: false
        units:
          type: integer
          format: int64
          required:
            - true
          default: 1

    SuggestedOrder:
      type: object
      properties:
        customerId:
          type: integer
          format: int64
        id:
          type: integer
          format: int64
        items:
          type: array
          items:
            $ref: "#/components/schemas/SuggestedOrderItem"
        lastUpdate:
          type: string
          format: date-time
        readDate:
          type: string
          format: date-time
        supplierName:
          type: string
      title: SuggestedOrder

    SuggestedOrderItem:
      type: object
      properties:
        categoryTitle:
          type: string
        productEan:
          type: string
        productImageId:
          type: string
        productTitle:
          type: string
        productUnits:
          type: integer
          format: int64
        quantity:
          type: integer
          format: int32
      title: SuggestedOrderItem

    SetSuggestOrderRequest:
      type: object
      properties:
        customer:
          $ref: "#/components/schemas/CustomerIntegrationIdentification"
        items:
          type: array
          items:
            $ref: "#/components/schemas/SuggestOrderItemRequest"
      title: SetSuggestOrderRequest

    SuggestOrderItemRequest:
      type: object
      properties:
        productEan:
          type: string
        productId:
          type: integer
          format: int64
        productUnits:
          type: integer
          format: int32
        quantity:
          type: integer
          format: int32
      title: SuggestOrderItemRequest

    Login:
      type: object
      properties:
        client:
          type: string
        secret:
          type: string

    SupplierIntegrationPriceListRequest:
      type: object
      properties:
        customerTypesCodes:
          type: array
          items:
            type: string
        customers:
          type: array
          items:
            $ref: "#/components/schemas/CustomerIntegrationIdentification"
        enabled:
          type: boolean
        name:
          type: string
      title: SupplierIntegrationPriceListRequest

    CustomerGetPriceListResponse:
      type: object
      properties:
        id:
          type: integer
          format: int64
        taxId:
          type: string
        supplierCode:
          type: string
        registered:
          type: boolean
      title: CustomerGetPriceListResponse

    CustomerIntegrationIdentification:
      type: object
      properties:
        id_type:
          type: string
          enum:
            - ID
            - SUPPLIER_CODE
            - TAX_ID
        value:
          type: string
      title: CustomerIntegrationIdentification

    CreatePriceListResponse:
      type: object
      properties:
        customer_types:
          type: array
          items:
            $ref: "#/components/schemas/CustomerTypeResponse"
        enabled:
          type: boolean
        id:
          type: string
        is_default:
          type: boolean
        name:
          type: string
        customers_found:
          type: array
          items:
            $ref: "#/components/schemas/CustomerIntegrationIdentification"
        customers_not_found:
          type: array
          items:
            $ref: "#/components/schemas/CustomerIntegrationIdentification"
        executionUuid:
          type: string
      title: CreatePriceListResponse

    CustomerTypeResponse:
      type: object
      properties:
        code:
          type: string
        id:
          type: string
        name:
          type: string
      title: CustomerTypeResponse

    SupplierPriceListIntegrationResponse:
      type: object
      properties:
        customer_types:
          type: array
          items:
            $ref: "#/components/schemas/CustomerTypeIntegrationResponse"
        customers:
          type: array
          items:
            $ref: "#/components/schemas/CustomerGetPriceListResponse"
        enabled:
          type: boolean
        price_list_code:
          type: string
        priceListId:
          type: integer
          format: int64
        is_default:
          type: boolean
        name:
          type: string
      title: SupplierPriceListIntegrationResponse

    CustomerTypeIntegrationResponse:
      type: object
      properties:
        code:
          type: string
        name:
          type: string
      title: CustomerTypeIntegrationResponse

    ResponseSuccess:
      type: object
      properties:
        uuid:
          type: string

    ResponseError:
      type: object
      properties:
        uuid:
          type: string
        error:
          type: string

    StatusUuidPagedResponse:
      type: object
      properties:
        pageInfo:
          $ref: "#/components/schemas/PageInfo"
        edges:
          type: array
          items:
            $ref: "#/components/schemas/EdgeStatusUuid"

    EdgeStatusUuid:
      type: object
      properties:
        cursor:
          $ref: "#/components/schemas/ConnectionCursor"
        node:
          $ref: "#/components/schemas/ErrorInfo"

    StatusUuidResponse:
      type: object
      properties:
        uuid:
          type: string
        status:
          type: string
        createDate:
          type: string
        response:
          type: string
        error:
          type: string
        stats:
          $ref: "#/components/schemas/Stats"

    Stats:
      type: object
      properties:
        total:
          type: integer
          format: int64
        processed:
          type: integer
          format: int64
        error:
          type: integer
          format: int64

    ErrorInfo:
      type: object
      properties:
        id:
          type: string
        reason:
          type: string

    StatusUuidPagedReponse:
      type: object
      properties:
        pageInfo:
          $ref: "#/components/schemas/PageInfo"
        edges:
          type: array
          items:
            $ref: "#/components/schemas/EdgeStatusUuid"

  securitySchemes:
    bearerAuth:
      type: "apiKey"
      scheme: "bearer"
      bearerFormat: "JWT"
      name: "Authorization"
      in: "header"
      description: "Put **_ONLY_** your JWT Bearer token on textbox below!"
      x-amazon-apigateway-authtype: "custom"
      x-amazon-apigateway-authorizer:
        authorizerResultTtlInSeconds: 300
        identitySource: "method.request.header.Authorization"
        type: "request"
        authorizerPayloadFormatVersion: "2.0"
        enableSimpleResponses: false


x-amazon-apigateway-binary-media-types:
  - "multipart/form-data"

